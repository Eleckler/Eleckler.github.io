<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>zznn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="努力做个博学而有趣的人">
<meta property="og:type" content="website">
<meta property="og:title" content="zznn">
<meta property="og:url" content="http://gegewu12.gitee.io/page/3/index.html">
<meta property="og:site_name" content="zznn">
<meta property="og:description" content="努力做个博学而有趣的人">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="zznn">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="zznn" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">zznn</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://gegewu12.gitee.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-编译部署nginx" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2nginx/" class="article-date">
  <time datetime="2023-05-15T09:26:39.000Z" itemprop="datePublished">2023-05-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/">常用软件</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2nginx/">编译部署nginx</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ubuntu-centos-nginx安装部署"><a href="#ubuntu-centos-nginx安装部署" class="headerlink" title="ubuntu centos nginx安装部署"></a>ubuntu centos nginx安装部署</h2><h3 id="一-ubuntu部署nginx"><a href="#一-ubuntu部署nginx" class="headerlink" title="一. ubuntu部署nginx"></a>一. ubuntu部署nginx</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#软件：nginx</span></span><br><span class="line"><span class="comment">#环境：centos7</span></span><br><span class="line"><span class="comment">#/usr/local/src/nginx-1.13.0/configure --prefix=/usr/local/nginx</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[33m </span></span><br><span class="line"><span class="string">                  1.此脚本只适用于首次安装部署,多次执行此脚本会覆盖nginx配置文件 \n </span></span><br><span class="line"><span class="string">                  2.想部署其他版本的需要自行更改链接:http://nginx.org/download/nginx-1.13.0.tar.gz 找到指定版本即可 \n \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ===========================start -初始化 \033[0m&quot;</span></span><br><span class="line"><span class="built_in">sleep</span> 2</span><br><span class="line">nginx_v=<span class="string">&quot;nginx-1.16.1.tar.gz&quot;</span> <span class="comment">#&quot;nginx-1.13.0.tar.gz&quot;</span></span><br><span class="line"><span class="built_in">dir</span>=<span class="string">&quot;nginx-1.16.1&quot;</span>            <span class="comment">#&quot;nginx-1.13.0&quot;</span></span><br><span class="line"><span class="comment">#yilai=&quot;gcc gcc-c++ make automake autoconf libtool pcre pcre-devel zlib zlib-devel openssl openssl-devel&quot;</span></span><br><span class="line"><span class="function"><span class="title">nginx_install_app</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 下载安装编译的依赖包 \033[0m&quot;</span></span><br><span class="line">    <span class="comment">#sudo apt-get update</span></span><br><span class="line">    <span class="comment">#安装依赖：gcc、g++依赖库</span></span><br><span class="line">    sudo apt-get install build-essential libtool -y</span><br><span class="line">    <span class="comment">#安装 pcre依赖库（http://www.pcre.org/）</span></span><br><span class="line">    sudo apt-get install libpcre3 libpcre3-dev -y</span><br><span class="line">    <span class="comment">#安装 zlib依赖库（http://www.zlib.net）</span></span><br><span class="line">    sudo apt-get install zlib1g-dev -y</span><br><span class="line">    <span class="comment">#安装ssl依赖库</span></span><br><span class="line">    sudo apt-get install openssl -y</span><br><span class="line">    sudo apt install zlib1g-dev openssl libssl-dev libpcre3 libpcre3-dev -y</span><br><span class="line">    [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 依赖：<span class="variable">$&#123;yilai&#125;</span> 安装完成 \033[0m&quot;</span>  || <span class="built_in">echo</span> -e <span class="string">&quot;\033[33m 依赖安装失败 \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m =============开始下载nginx压缩包 \033[0m&quot;</span></span><br><span class="line">    wget http://nginx.org/download/<span class="variable">$&#123;nginx_v&#125;</span></span><br><span class="line">    tar -zxvf ./<span class="variable">$&#123;nginx_v&#125;</span> -C  /usr/local/src/</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">nginx_make</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 开始编译安装：<span class="variable">$&#123;nginx_v&#125;</span> \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">cd</span> /usr/local/src/<span class="variable">$&#123;dir&#125;</span> &amp;&amp; ./configure --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-http_realip_module --with-http_slice_module --with-stream</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m make  \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">cd</span> /usr/local/src/<span class="variable">$&#123;dir&#125;</span> &amp;&amp;  make</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m make install \033[0m&quot;</span> </span><br><span class="line">    <span class="built_in">cd</span> /usr/local/src/<span class="variable">$&#123;dir&#125;</span> &amp;&amp;  make install</span><br><span class="line">    [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 依赖：编译安装完成全路径启动命令&quot;</span>/usr/local/nginx/sbin/nginx<span class="string">&quot; \033[0m&quot;</span>  || <span class="built_in">echo</span> -e <span class="string">&quot;\033[33m 编译安装失败 \033[0m&quot;</span></span><br><span class="line">    /usr/local/nginx/sbin/nginx -t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">nginx_system</span></span>() &#123;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ==============================开始建立&#x27;nginx&#x27;托管文件 \033[0m&quot;</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;/usr/lib/systemd/system/nginx.service</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=nginx server</span></span><br><span class="line"><span class="string">Documentation=http://nginx.org/en/docs/</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string">#Type=simple</span></span><br><span class="line"><span class="string">#PIDFile=/usr/local/nginx/logs/nginx.pid</span></span><br><span class="line"><span class="string">ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span></span><br><span class="line"><span class="string">ExecReload=/bin/kill -SIGHUP \$MAINPID</span></span><br><span class="line"><span class="string">ExecStop=/bin/kill -SIGINT \$MAINPID</span></span><br><span class="line"><span class="string">Restart=always</span></span><br><span class="line"><span class="string">RestartSec=5</span></span><br><span class="line"><span class="string">#StartLimitInterval=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">   systemctl daemon-reload</span><br><span class="line">   systemctl start  nginx.service</span><br><span class="line">   systemctl status nginx.service</span><br><span class="line">   <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m</span></span><br><span class="line"><span class="string">   概览 </span></span><br><span class="line"><span class="string">   nginx安装完成访问方式-----------------------------------浏览器访问: http://localhost</span></span><br><span class="line"><span class="string">   1. nginx执行文件全路径为:&quot;</span>/usr/local/nginx/sbin/nginx<span class="string">&quot; 若要使用nginx命令需要以 全路径方式</span></span><br><span class="line"><span class="string">   2. nginx 常用命令：</span></span><br><span class="line"><span class="string">      /usr/local/nginx/sbin/nginx -v # -V 查看编译模块 </span></span><br><span class="line"><span class="string">      /usr/local/nginx/sbin/nginx -V</span></span><br><span class="line"><span class="string">      /usr/local/nginx/sbin/nginx -t 等</span></span><br><span class="line"><span class="string">   3. ----------------------------------------------------nginx版本为: </span></span><br><span class="line"><span class="string">   \033[0m&quot;</span></span><br><span class="line">   /usr/local/nginx/sbin/nginx -v</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">    nginx_install_app</span><br><span class="line">    nginx_make</span><br><span class="line">    nginx_system</span><br><span class="line">&#125;</span><br><span class="line">main</span><br></pre></td></tr></table></figure>

<h3 id="二-centos部署nginx"><a href="#二-centos部署nginx" class="headerlink" title="二.  centos部署nginx"></a>二.  centos部署nginx</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#软件：nginx</span></span><br><span class="line"><span class="comment">#环境：centos7</span></span><br><span class="line"><span class="comment">#/usr/local/src/nginx-1.13.0/configure --prefix=/usr/local/nginx</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[33m </span></span><br><span class="line"><span class="string">                  1.此脚本只适用于首次安装部署,多次执行此脚本会覆盖nginx配置文件 \n </span></span><br><span class="line"><span class="string">                  2.想部署其他版本的需要自行更改链接:http://nginx.org/download/nginx-1.13.0.tar.gz 找到指定版本即可 \n \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ===========================start -初始化 \033[0m&quot;</span></span><br><span class="line"><span class="built_in">sleep</span> 8</span><br><span class="line">nginx_v=<span class="string">&quot;nginx-1.16.1.tar.gz&quot;</span> <span class="comment">#&quot;nginx-1.13.0.tar.gz&quot;</span></span><br><span class="line"><span class="built_in">dir</span>=<span class="string">&quot;nginx-1.16.1&quot;</span> <span class="comment"># &quot;nginx-1.13.0&quot;</span></span><br><span class="line">yilai=<span class="string">&quot;gcc gcc-c++ make automake autoconf libtool pcre pcre-devel zlib zlib-devel openssl openssl-devel&quot;</span></span><br><span class="line"><span class="function"><span class="title">nginx_install_app</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 下载安装编译的依赖包 \033[0m&quot;</span></span><br><span class="line">    yum install <span class="variable">$&#123;yilai&#125;</span> -y</span><br><span class="line">    [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 依赖：<span class="variable">$&#123;yilai&#125;</span> 安装完成 \033[0m&quot;</span>  || <span class="built_in">echo</span> -e <span class="string">&quot;\033[33m 依赖安装失败 \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m =============开始下载nginx压缩包 \033[0m&quot;</span></span><br><span class="line">    wget http://nginx.org/download/<span class="variable">$&#123;nginx_v&#125;</span></span><br><span class="line">    tar -zxvf ./<span class="variable">$&#123;nginx_v&#125;</span> -C  /usr/local/src/</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">nginx_make</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 开始编译安装：<span class="variable">$&#123;nginx_v&#125;</span> \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">cd</span> /usr/local/src/<span class="variable">$&#123;dir&#125;</span> &amp;&amp; ./configure --prefix=/usr/local/nginx --with-http_ssl_module --with-http_stub_status_module --with-http_realip_module --with-http_slice_module --with-stream</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m make  \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">cd</span> /usr/local/src/<span class="variable">$&#123;dir&#125;</span> &amp;&amp;  make</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m make install \033[0m&quot;</span> </span><br><span class="line">    <span class="built_in">cd</span> /usr/local/src/<span class="variable">$&#123;dir&#125;</span> &amp;&amp;  make install</span><br><span class="line">    [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 依赖：编译安装完成全路径启动命令&quot;</span>/usr/local/nginx/sbin/nginx<span class="string">&quot; \033[0m&quot;</span>  || <span class="built_in">echo</span> -e <span class="string">&quot;\033[33m 编译安装失败 \033[0m&quot;</span></span><br><span class="line">    /usr/local/nginx/sbin/nginx -t</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">nginx_system</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ==============================开始建立&#x27;nginx&#x27;托管文件 \033[0m&quot;</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;/usr/lib/systemd/system/nginx.service</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=nginx - high performance web server</span></span><br><span class="line"><span class="string">Documentation=http://nginx.org/en/docs/</span></span><br><span class="line"><span class="string">After=network-online.target remote-fs.target nss-lookup.target</span></span><br><span class="line"><span class="string">Wants=network-online.target</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string">PIDFile=/usr/local/nginx/logs/nginx.pid</span></span><br><span class="line"><span class="string">ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span></span><br><span class="line"><span class="string">ExecReload=/bin/kill -s HUP \$MAINPID</span></span><br><span class="line"><span class="string">ExecStop=/bin/kill -s TERM \$MAINPID</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">   systemctl daemon-reload</span><br><span class="line">   systemctl start  nginx.service</span><br><span class="line">   systemctl status nginx.service</span><br><span class="line">   nginx_cmd=`/usr/local/nginx/sbin/nginx -v`</span><br><span class="line">   <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m</span></span><br><span class="line"><span class="string">   概览 </span></span><br><span class="line"><span class="string">   nginx安装完成访问方式-----------------------------------浏览器访问: http://localhost</span></span><br><span class="line"><span class="string">   1. 自动检查nginx安装成功--------------------------------nginx版本为:<span class="variable">$&#123;nginx_cmd&#125;</span> </span></span><br><span class="line"><span class="string">   2. nginx执行文件全路径为:&quot;</span>/usr/local/nginx/sbin/nginx<span class="string">&quot; 若要使用nginx命令需要以 全路径方式</span></span><br><span class="line"><span class="string">   3. nginx 常用命令：</span></span><br><span class="line"><span class="string">      /usr/local/nginx/sbin/nginx -v </span></span><br><span class="line"><span class="string">      /usr/local/nginx/sbin/nginx -t 等</span></span><br><span class="line"><span class="string">   \033[0m&quot;</span></span><br><span class="line">      /usr/local/nginx/sbin/nginx -v</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">    nginx_install_app</span><br><span class="line">    nginx_make</span><br><span class="line">    nginx_system</span><br><span class="line">&#125;</span><br><span class="line">main</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2nginx/" data-id="cli02gti400468cqmfqiu4pah" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/" rel="tag">常用软件</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" rel="tag">环境部署</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-编译部署keepalived" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2keepalived/" class="article-date">
  <time datetime="2023-05-15T09:18:48.000Z" itemprop="datePublished">2023-05-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/">常用软件</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2keepalived/">编译部署keepalived</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="编译部署keepalived"><a href="#编译部署keepalived" class="headerlink" title="编译部署keepalived"></a>编译部署<code>keepalived</code></h2><h3 id="一-centos-编译部署keepalived"><a href="#一-centos-编译部署keepalived" class="headerlink" title="一. centos 编译部署keepalived"></a>一. centos 编译部署keepalived</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#环境：centos7</span></span><br><span class="line"><span class="comment">#软件版：keepalived-2.0.18.tar.gz </span></span><br><span class="line"><span class="built_in">dir</span>=<span class="string">&quot;/usr/local/src&quot;</span></span><br><span class="line">keepalived=<span class="string">&quot;keepalived-2.0.18&quot;</span></span><br><span class="line">keepalived_v=<span class="string">&quot;keepalived-2.0.18.tar.gz&quot;</span></span><br><span class="line">yilai=<span class="string">&quot;openssl openssl-devel wget vim lrzsz&quot;</span></span><br><span class="line"><span class="function"><span class="title">keepalived_make</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[33m 此脚本容错率较低请不要重复执行 \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">sleep</span> 10</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ===============开始拉取安装包:<span class="variable">$&#123;keepalived_v&#125;</span> \033[0m&quot;</span> </span><br><span class="line">    wget --no-check-certificate https://www.keepalived.org/software/<span class="variable">$&#123;keepalived_v&#125;</span></span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 解压到： <span class="variable">$&#123;dir&#125;</span>  \033[0m&quot;</span> </span><br><span class="line">    tar -zxvf ./<span class="variable">$&#123;keepalived_v&#125;</span> -C <span class="variable">$&#123;dir&#125;</span></span><br><span class="line">    yum install -y <span class="variable">$&#123;yilai&#125;</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;keepalived&#125;</span>/ &amp;&amp; ./configure --prefix=/usr/local/keepalived</span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;keepalived&#125;</span>/ &amp;&amp; make </span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;keepalived&#125;</span>/ &amp;&amp; make install</span><br><span class="line">    [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m 编译安装<span class="variable">$&#123;keepalived&#125;</span>成功 \033[0m&quot;</span>  || <span class="built_in">echo</span> -e <span class="string">&quot;\033[33m 编译安装<span class="variable">$&#123;keepalived&#125;</span>失败 \033[0m&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">keepalived_system</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ===============开始配置：<span class="variable">$&#123;keepalived&#125;</span> \033[0m&quot;</span></span><br><span class="line">    [ -d <span class="string">&quot;/etc/keepalived&quot;</span> ] || <span class="built_in">mkdir</span> -p /etc/keepalived</span><br><span class="line">    <span class="built_in">cp</span> /usr/local/keepalived/etc/keepalived/keepalived.conf /etc/keepalived/</span><br><span class="line">    <span class="built_in">cp</span> /usr/local/keepalived/sbin/keepalived /etc/init.d/</span><br><span class="line">    systemctl daemon-reload</span><br><span class="line">    systemctl start keepalived </span><br><span class="line">    systemctl <span class="built_in">enable</span> keepalived </span><br><span class="line">    systemctl status keepalived </span><br><span class="line">    <span class="built_in">echo</span> -e <span class="string">&quot;\033[36m </span></span><br><span class="line"><span class="string">            常用命令：</span></span><br><span class="line"><span class="string">            systemctl restart keepalived </span></span><br><span class="line"><span class="string">            systemctl status keepalived </span></span><br><span class="line"><span class="string">            systemctl enable keepalived            </span></span><br><span class="line"><span class="string">            \033[0m&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;keepalived版本是:&quot;</span></span><br><span class="line">    /usr/local/keepalived/sbin/keepalived -v</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">    keepalived_make</span><br><span class="line">    keepalived_system</span><br><span class="line">&#125;</span><br><span class="line">main</span><br></pre></td></tr></table></figure>

<h3 id="二-ubuntu部署keepailved"><a href="#二-ubuntu部署keepailved" class="headerlink" title="二. ubuntu部署keepailved"></a>二. ubuntu部署keepailved</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1 查看keepalived软件版本</span><br><span class="line"><span class="comment"># apt-cache madison keepalived</span></span><br><span class="line">keepalived | 1:2.0.19-2 | http://mirrors.aliyun.com/ubuntu focal/main amd64 Packages</span><br><span class="line">2.2 安装keepalived</span><br><span class="line"><span class="comment"># apt -y install keepalived</span></span><br><span class="line">2.3 准备keepalived.conf文件</span><br><span class="line"><span class="comment"># cp /usr/share/doc/keepalived/samples/keepalived.conf.sample /etc/keepalived/keepalived.conf</span></span><br><span class="line">2.4 修改keepalived.conf文件 （不执行）</span><br><span class="line"><span class="comment"># sed -i &#x27;s@interface eth0@interface ens33@g&#x27; /etc/keepalived/keepalived.conf </span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2keepalived/" data-id="cli02gthr00268cqmcftu33u7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/" rel="tag">常用软件</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" rel="tag">环境部署</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-各种加速器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/15/%E5%90%84%E7%A7%8D%E5%8A%A0%E9%80%9F%E5%99%A8/" class="article-date">
  <time datetime="2023-05-15T09:04:13.000Z" itemprop="datePublished">2023-05-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/club/">club</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/15/%E5%90%84%E7%A7%8D%E5%8A%A0%E9%80%9F%E5%99%A8/">各种加速器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="linux各种加速器"><a href="#linux各种加速器" class="headerlink" title="linux各种加速器"></a>linux各种加速器</h2><h3 id="一-pip加速"><a href="#一-pip加速" class="headerlink" title="一. pip加速"></a>一. pip加速</h3><p>新版ubuntu要求使用https源，要注意。<br>清华：<a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a><br>阿里云：<a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/pypi/simple/">http://mirrors.aliyun.com/pypi/simple/</a><br>中国科技大学 <a target="_blank" rel="noopener" href="https://pypi.mirrors.ustc.edu.cn/simple/">https://pypi.mirrors.ustc.edu.cn/simple/</a><br>华中理工大学：<a target="_blank" rel="noopener" href="http://pypi.hustunique.com/">http://pypi.hustunique.com/</a><br>山东理工大学：<a target="_blank" rel="noopener" href="http://pypi.sdutlinux.org/">http://pypi.sdutlinux.org/</a><br>豆瓣：<a target="_blank" rel="noopener" href="http://pypi.douban.com/simple/">http://pypi.douban.com/simple/</a></p>
<p>临时使用：<br>可以在使用pip的时候加参数-i <a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a><br>例如：pip install -i <a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a> pyspider，这样就会从清华这边的镜像去安装pyspider库。</p>
<p>永久修改，一劳永逸：<br>更换pip源<br>mkdir ~/.pip<br>sudo vi ~/.pip/pip.conf<br>输入以下内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">trusted-host = pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure>

<h3 id="二-docker加速器"><a href="#二-docker加速器" class="headerlink" title="二. docker加速器"></a>二. docker加速器</h3><p>针对Docker客户端版本大于 1.10.0 的用户<br>您可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器<br>加速器列表：自行阿里云容器镜像服务获取 <a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/">https://cr.console.aliyun.com/</a></p>
<img src="/2023/05/15/%E5%90%84%E7%A7%8D%E5%8A%A0%E9%80%9F%E5%99%A8/image-20230515171013260.png" alt="image-20230515171013260" style="zoom:67%;">


      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/15/%E5%90%84%E7%A7%8D%E5%8A%A0%E9%80%9F%E5%99%A8/" data-id="cli02gtho001u8cqm7utrf7o0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/club/" rel="tag">club</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" rel="tag">环境部署</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ubuntu-ufw配置" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/" class="article-date">
  <time datetime="2023-05-13T12:55:50.000Z" itemprop="datePublished">2023-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ubuntu/">ubuntu</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/">ubuntu-ufw配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ubuntu-ufw-配置"><a href="#ubuntu-ufw-配置" class="headerlink" title="ubuntu-ufw 配置"></a>ubuntu-ufw 配置</h2><p>参考：</p>
<p> <a target="_blank" rel="noopener" href="https://ednovas.xyz/2021/08/15/ufw/">https://ednovas.xyz/2021/08/15/ufw/</a></p>
<p> 前言：</p>
<p>只有防火墙内部有规则的时候 使用 ufw status /ufw status verbose 才能显示规则 情况 否则显示 /活动/不活动/激活/未激活</p>
<p>防火墙拓补：</p>
<p><img src="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/image-20230522104450862.png" alt="image-20230522104450862"></p>
<h3 id="一-重置防火墙会把所有已添加的规则全部删除并且禁用防火墙"><a href="#一-重置防火墙会把所有已添加的规则全部删除并且禁用防火墙" class="headerlink" title="一.  重置防火墙会把所有已添加的规则全部删除并且禁用防火墙"></a>一.  重置防火墙会把所有已添加的规则全部删除并且禁用防火墙</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 常规操作</span></span><br><span class="line">sudo ufw reset //重置防火墙</span><br><span class="line">sudo ufw <span class="built_in">disable</span> //禁用防火墙</span><br><span class="line">sudo ufw <span class="built_in">enable</span> //开启防火墙</span><br><span class="line">sudo ufw status 查看防火墙状态</span><br><span class="line">sudo ufw <span class="built_in">enable</span> 开启防火墙</span><br><span class="line">sudo ufw status verbose 查看比status查看的更详细的防火墙</span><br><span class="line">sudo ufw <span class="built_in">enable</span></span><br><span class="line">sudo ufw default deny</span><br><span class="line">sudo ufw allow ssh   允许ssh服务</span><br><span class="line">sudo ufw deny ssh    禁用ssh服务</span><br><span class="line">sudo ufw logging on  启用日志记录</span><br><span class="line">sudo ufw logging off 禁用日志记录</span><br><span class="line">sudo ufw status verbose 查看防火墙状态</span><br><span class="line">sudo ufw status verbose 查看比status查看的更详细</span><br><span class="line"></span><br><span class="line">sudo ufw allow 53 允许端口53上传入tcp udp数据包</span><br><span class="line">sudo ufw allow 53/tcp 允许端口53上传入tcp 数据包</span><br><span class="line"><span class="comment"># Deny（拒绝）</span></span><br><span class="line">sudo ufw deny 53 拒绝端口53上的tcp udp数据包</span><br><span class="line">sudo ufw deny 53/tcp 拒绝端口53上传的tcp 数据包</span><br><span class="line">sudo ufw deny 53/udp 允许端口53上传入udp数据包</span><br><span class="line"><span class="comment"># 删除现有规则 要删除规则只需要在原始规则前面加上delete即可。例如，如果原始规则是：</span></span><br><span class="line">sudo ufw deny 80/tcp 以前的规则是拒绝80/tcp端口上传的数据</span><br><span class="line">sudo ufw delete deny 80/tcp 现在删除这个规则</span><br><span class="line">server（服务）</span><br><span class="line"><span class="comment"># 可以通过服务名称允许或拒绝，因为ufw从/etc/services读取服务名称</span></span><br></pre></td></tr></table></figure>

<h3 id="二-要查看获取服务列表"><a href="#二-要查看获取服务列表" class="headerlink" title="二. 要查看获取服务列表"></a>二. 要查看获取服务列表</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按服务名称允许</span></span><br><span class="line">22.sudo ufw allow &lt;服务名称&gt; </span><br><span class="line">23.sudo ufw allow ssh.service 按服务名称允许</span><br><span class="line">24.sudo ufw deny by service name </span><br><span class="line">25.sudo ufw deny &lt;服务名称&gt; 按服务名称拒绝</span><br><span class="line"><span class="comment"># Logging关于ufw的日志</span></span><br><span class="line">sudo ufw logging on启用日志</span><br><span class="line">sudo ufw logging off禁用日志</span><br></pre></td></tr></table></figure>

<h3 id="三-高级语法"><a href="#三-高级语法" class="headerlink" title="三. 高级语法"></a>三. 高级语法</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 允许特定ip访问</span></span><br><span class="line">1.sudo ufw allow from &lt;ip address&gt; 特定ip允许</span><br><span class="line">2.sudo ufw allow from 207.46.132.182 允许此ip访问我的服务器</span><br><span class="line"><span class="comment"># 子网允许 可使用网络掩码 （允许来自207....的数据包）</span></span><br><span class="line">14. sudo ufw allow from 207.46.132.182 0/24</span><br><span class="line">1.通过特定端口和ip地址允许</span><br><span class="line">sudo ufw allow from &lt;target&gt; to &lt;destination&gt; port &lt;port number&gt;</span><br><span class="line">例子1 允许ip地址192.168.0.4访问所有协议的端口22</span><br><span class="line">sudo ufw allow from 192.168..... to any port 22</span><br><span class="line">2.通过特定ip地址和协议允许</span><br><span class="line">sudo ufw allow from &lt;target&gt; to &lt;destination&gt; port &lt;port number&gt; proto &lt;protocol name&gt;</span><br><span class="line">示例：允许 IP 地址 192.168.0.4 使用 TCP 访问端口 22</span><br><span class="line">sudo ufw allow from 192.168.....to any port 22 proto tcp</span><br></pre></td></tr></table></figure>

<h3 id="四-启用-禁PING-不常用"><a href="#四-启用-禁PING-不常用" class="headerlink" title="四. 启用 /  禁PING(不常用)"></a>四. 启用 /  禁PING(不常用)</h3><p>注意：对于现代破解脚本来说，默默无闻的安全性可能没有什么实际好处。默认情况下，UFW 允许 ping 请求。您可能会发现您希望启用 (icmp) ping 请求以诊断网络问题。<br>为了禁用 ping (icmp) 请求，您需要编辑/etc/ufw/before.rules并删除以下行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ok icmp codes for INPUT</span></span><br><span class="line">-A ufw-before-input -p icmp --icmp-type destination-unreachable -j ACCEPT</span><br><span class="line">-A ufw-before-input -p icmp --icmp-type time-exceeded -j ACCEPT</span><br><span class="line">-A ufw-before-input -p icmp --icmp-type parameter-problem -j ACCEPT</span><br><span class="line">-A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT</span><br><span class="line"><span class="comment"># 将允许改为删除</span></span><br><span class="line">-A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT &gt;&gt; DROP</span><br><span class="line">-A ufw-before-input -p icmp --icmp-type echo-request -j DROP</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/image-20230513211430569.png" alt="image-20230513211430569"></p>
<p><img src="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/image-20230513210304793.png" alt="image-20230513210304793"></p>
<h3 id="五．拒绝访问"><a href="#五．拒绝访问" class="headerlink" title="五．拒绝访问"></a>五．拒绝访问</h3><p>被特定 IP 拒绝 不允许ip访问我的服务器<br>sudo ufw deny from ip <ip address><br>示例：拒绝所有协议的 ip 地址 192.168.0.3访问<br>sudo ufw deny from 192.168.0.3 阻止来自192.168.0.3的数据</ip></p>
<p><img src="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/image-20230513210413321.png" alt="image-20230513210413321"></p>
<p>通过特定端口和 IP 地址拒绝<br>sudo ufw deny from <ip address> to <protocol> port <port number><br>拒绝所有协议的 ip 地址 192.168.0.1 访问端口 22</port></protocol></ip></p>
<img src="/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/image-20230513210432231.png" alt="image-20230513210432231">

      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/13/ubuntu-ufw%E9%85%8D%E7%BD%AE/" data-id="cli02gthi001a8cqm54iffhoa" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" rel="tag">环境部署</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Dockerfile构建telegraf-py版及oracle客户端" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/12/Dockerfile%E6%9E%84%E5%BB%BAtelegraf-py%E7%89%88%E5%8F%8Aoracle%E5%AE%A2%E6%88%B7%E7%AB%AF/" class="article-date">
  <time datetime="2023-05-12T06:19:44.000Z" itemprop="datePublished">2023-05-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/">云原生监控</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/12/Dockerfile%E6%9E%84%E5%BB%BAtelegraf-py%E7%89%88%E5%8F%8Aoracle%E5%AE%A2%E6%88%B7%E7%AB%AF/">Dockerfile构建telegraf_py版及oracle客户端</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>概览：</p>
<p>容器内：</p>
<ol>
<li>部署telegraf</li>
<li>部署oracle客户端</li>
<li>安装python3环境</li>
<li>安装cx_Oracle库</li>
</ol>
<p>脚本用于构建<code>telegraf python</code>环境 配合<code>python</code>脚本用于监控<code>oracle</code></p>
<p>功能</p>
<ol>
<li>内部配置完成python环境</li>
<li>容器内可访问外部网络</li>
<li>内部部署oracle客户端容器构建完成后可连接oracle数据库</li>
</ol>
<h3 id="一-启动脚本"><a href="#一-启动脚本" class="headerlink" title="一.  启动脚本"></a>一.  启动脚本</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#oracle</span></span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=/home/oracle/instantclient_11_2</span><br><span class="line"><span class="built_in">export</span> TNS_ADMIN=<span class="variable">$ORACLE_HOME</span>/network/admin</span><br><span class="line"><span class="comment">#export NLS_LANG=AMERICAN_AMERICA.ZHS16GBK</span></span><br><span class="line"><span class="built_in">export</span> NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$ORACLE_HOME</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$ORACLE_HOME</span>:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment">#source /etc/profile</span></span><br><span class="line"><span class="built_in">nohup</span> /opt/telegraf-1.20.4/usr/bin/telegraf --config /opt/telegraf-1.20.4/etc/telegraf/telegraf.conf \</span><br><span class="line"> --config-directory /opt/telegraf-1.20.4/etc/telegraf/telegraf.d &amp;</span><br></pre></td></tr></table></figure>

<p>dockerfile脚本</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos:<span class="number">7</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum update -y</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum install -y python3 \</span></span><br><span class="line"><span class="language-bash">&amp;&amp;  yum -y install epel-release </span></span><br><span class="line"><span class="comment">#yum update -y \</span></span><br><span class="line"><span class="comment">#yum install -y python3 \</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum install -y python-pip </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash">  pip3 install --upgrade pip==19.3.1 </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash">  pip3 install cx_Oracle </span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash">  yum install -y unzip \</span></span><br><span class="line"><span class="language-bash">&amp;&amp;  <span class="built_in">mkdir</span> -p /opt/telegraf</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> ./telegraf-1.20.4_linux_amd64.tar.gz /opt/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> a+x /opt/telegraf-1.20.4/usr/bin/telegraf</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./telegraf.conf /opt/telegraf-1.20.4/etc/telegraf/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./qidong.sh /opt/telegraf-1.20.4/ </span></span><br><span class="line"><span class="comment">#COPY ./telegraf.conf /opt/telegraf/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> a+x /opt/telegraf-1.20.4/qidong.sh</span></span><br><span class="line"><span class="comment">#构建oracle客客户端</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./profile /etc</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /home/oracle \</span></span><br><span class="line"><span class="language-bash">&amp;&amp;  <span class="built_in">chmod</span> 755 /home/oracle -R \</span></span><br><span class="line"><span class="language-bash">&amp;&amp;  yum install -y libaio* \</span></span><br><span class="line"><span class="language-bash">&amp;&amp;  yum install -y vim </span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> ./instantclient_11_2.tar.gz /home/oracle/</span></span><br><span class="line"><span class="comment">#RUN unzip /home/oracle/instantclient-basic-linux.x64-11.2.0.4.0.zip \</span></span><br><span class="line"><span class="comment">#&amp;&amp; unzip /home/oracle/instantclient-precomp-linux-11.2.0.4.0.zip \</span></span><br><span class="line"><span class="comment">#&amp;&amp; unzip /home/oracle/instantclient-sdk-linux.x64-11.2.0.4.0.zip \</span></span><br><span class="line"><span class="comment">#&amp;&amp; unzip /home/oracle/instantclient-sqlplus-linux.x64-11.2.0.4.0.zip</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8092</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8094</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8152</span></span><br><span class="line"><span class="comment">#CMD [&quot;/opt/telegraf-1.20.4/usr/bin/telegraf --config /opt/telegraf-1.20.4/etc/telegraf/telegraf.conf \</span></span><br><span class="line"><span class="comment">#--config-directory /opt/telegraf-1.20.4/etc/telegraf/telegraf.d&quot;]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;bash /opt/telegraf-1.20.4/qidong.sh&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>build</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建</span></span><br><span class="line">docker build -f /home/Dockerfile/Dockerfile -t zznn/telegraf .</span><br><span class="line"><span class="comment"># push到私人仓库</span></span><br><span class="line"><span class="comment"># 拉取</span></span><br><span class="line">docker pull registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:telegraf_oracle-py</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/12/Dockerfile%E6%9E%84%E5%BB%BAtelegraf-py%E7%89%88%E5%8F%8Aoracle%E5%AE%A2%E6%88%B7%E7%AB%AF/image-20230512142122678.png" alt="image-20230512142122678"></p>
<p>结语祝好！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/12/Dockerfile%E6%9E%84%E5%BB%BAtelegraf-py%E7%89%88%E5%8F%8Aoracle%E5%AE%A2%E6%88%B7%E7%AB%AF/" data-id="cli02gtgr00008cqm4iir0d97" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/" rel="tag">云原生监控</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-vmware-v2v迁移脚本" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/12/vmware-v2v%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC/" class="article-date">
  <time datetime="2023-05-12T06:04:20.000Z" itemprop="datePublished">2023-05-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%BF%81%E4%BA%91/">迁云</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/12/vmware-v2v%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC/">vmware_v2v迁移脚本</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="v2v迁移vmware脚本"><a href="#v2v迁移vmware脚本" class="headerlink" title="v2v迁移vmware脚本"></a><code>v2v</code>迁移<code>vmware</code>脚本</h2><h3 id="一-vmware-sh"><a href="#一-vmware-sh" class="headerlink" title="一. vmware.sh"></a>一. vmware.sh</h3><p>脚本功能 半自动的迁移脚本（vmware.sh）<br>功能：<br>自动安装windows驱动<br>自动导出vmware虚拟机为qcm2格式<br>自动安装could-init（centos7 ubuntu）ubuntu安装could-init未成功</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#v2v半自动迁移脚本</span></span><br><span class="line"><span class="comment">#环境centos7</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line">red=<span class="string">&quot;31m&quot;</span></span><br><span class="line">green=<span class="string">&quot;36m&quot;</span></span><br><span class="line">could_init_v=<span class="string">&quot;1662444422717_install-cloudinit-scripts.zip&quot;</span></span><br><span class="line">could_init=<span class="string">&quot;https://www.wangsu.com/wos/draft/news/1662444422565/<span class="variable">$&#123;could_init_v&#125;</span>&quot;</span></span><br><span class="line">exsi_ip=<span class="string">&quot;exsi-ip&quot;</span></span><br><span class="line"><span class="comment">#environment() &#123;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> </span></span><br><span class="line"><span class="string">            执行安装v2v  \033[0m&quot;</span></span><br><span class="line">app=<span class="string">&quot;qemu-kvm libvirt virt-manager virt-v2v wget&quot;</span></span><br><span class="line">yum install -y <span class="variable">$&#123;app&#125;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> </span></span><br><span class="line"><span class="string">            执行安装windows驱动  \033[0m&quot;</span></span><br><span class="line">yum install libguestfs-winsupport libguestfs-tools -y</span><br><span class="line">wget https://fedorapeople.org/groups/virt/virtio-win/virtio-win.repo -O /etc/yum.repos.d/virtio-win.repo --no-check-certificate</span><br><span class="line">yum install virtio-win -y</span><br><span class="line">[ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> windows驱动安装完成  \033[0m&quot;</span></span><br><span class="line">systemctl start libvirtd &amp;&amp; systemctl <span class="built_in">enable</span> libvirtd</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> </span></span><br><span class="line"><span class="string">            期间会多次输入esxi密码建议不要输错多次输错会导致 exsi锁定</span></span><br><span class="line"><span class="string">            输入exsi密码 列出exsi下虚拟机 \033[0m&quot;</span></span><br><span class="line">virsh -c esx://root@<span class="variable">$&#123;exsi_ip&#125;</span>?no_verify=1 list --all </span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;在上述列表中选取输入需要执行导出的虚拟机: &quot;</span> vmware_host</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> </span></span><br><span class="line"><span class="string">            你输入的虚拟机是：<span class="variable">$&#123;vmware_host&#125;</span> \033[0m&quot;</span></span><br><span class="line"><span class="built_in">sleep</span> 4</span><br><span class="line">[ ! -d <span class="variable">$&#123;vmware_host&#125;</span> ] &amp;&amp; <span class="built_in">mkdir</span> -p <span class="variable">$&#123;vmware_host&#125;</span> || <span class="literal">true</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line"><span class="function"><span class="title">export_vmware</span></span>() &#123;</span><br><span class="line">   <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> </span></span><br><span class="line"><span class="string">                执行导出<span class="variable">$&#123;vmware_host&#125;</span>虚拟机为vmdk格式文件 </span></span><br><span class="line"><span class="string">                输入exsi密码 可能重复要求输入多次 \033[0m&quot;</span></span><br><span class="line">   virt-v2v-copy-to-local -ic esx://root@<span class="variable">$&#123;exsi_ip&#125;</span>/?no_verify=1 <span class="variable">$&#123;vmware_host&#125;</span></span><br><span class="line">   [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 执行导出成功  \033[0m&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">change_format</span></span>() &#123;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 执行转换格式  \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;进入引导</span></span><br><span class="line"><span class="string">      0.输入0 获取帮助 </span></span><br><span class="line"><span class="string">      1.输入1 存在数据盘   只转换系统盘格式为qcm2 </span></span><br><span class="line"><span class="string">      2.输入2 不存在数据盘 直接执行转换为qcm2 或 系统盘和数据盘一起转换为qcm2格式  </span></span><br><span class="line"><span class="string">      3.输入3 退出格式转换步骤&quot;</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">read</span> -p <span class="string">&quot;请输入数字 0 1 2 3 : &quot;</span> n  </span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$n</span> <span class="keyword">in</span></span><br><span class="line">0)<span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> </span></span><br><span class="line"><span class="string">     帮助信息:</span></span><br><span class="line"><span class="string">        1. 当虚拟机存在数据盘 只需要转换系统盘为qcm2格式时需要 手动修改xml中关于数据盘的配置部分 </span></span><br><span class="line"><span class="string">        2. 当虚拟机只存在系统盘则直接执行转换系统盘格式为qcm2格式</span></span><br><span class="line"><span class="string">        3. 导入云平台创建云主机 开机需要注释：/etc/fstab相关配置</span></span><br><span class="line"><span class="string">        4. 转换格式后的文件将存放于脚本自动创建的虚拟机同名文件夹</span></span><br><span class="line"><span class="string">        5. 导出后需要手动迁移数据盘建议挂载磁盘后采用dd的方式克隆数据</span></span><br><span class="line"><span class="string">           或: qemu-img convert -f qcow2 -O raw Qcms1-data.qcow2 /dev/vdb </span></span><br><span class="line"><span class="string">           此种方式dd与qemu集成 可直接将qcm2转为raw格式后克隆到磁盘若选择此种方式则下方输入引导项: &#x27;2&#x27; 导出.</span></span><br><span class="line"><span class="string">        6. 输入3退出此步骤执行下一步 输入0 1 2 则执行对应步骤  \033[0m&quot;</span>  </span><br><span class="line">  <span class="built_in">continue</span></span><br><span class="line">  ;;</span><br><span class="line">1)<span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 存在数据盘 只转换系统盘格式为qcm2  \033[0m&quot;</span>        </span><br><span class="line">        <span class="built_in">cp</span> <span class="variable">$&#123;vmware_host&#125;</span>.xml&#123;,.bak&#125;</span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 手动修改xml文件系统盘部分 \033[0m&quot;</span></span><br><span class="line">        <span class="built_in">sleep</span> 4</span><br><span class="line">        vim <span class="variable">$&#123;vmware_host&#125;</span>.xml</span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 开始导出 \033[0m&quot;</span></span><br><span class="line">        virt-v2v -i libvirtxml <span class="variable">$&#123;vmware_host&#125;</span>.xml -o <span class="built_in">local</span> -os <span class="variable">$&#123;vmware_host&#125;</span>/ -of qcow2 --compressed</span><br><span class="line">        [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;vmware_host&#125;</span>vmdk导出成功 \033[0m&quot;</span></span><br><span class="line">  <span class="built_in">continue</span></span><br><span class="line">  ;;</span><br><span class="line">2)<span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 不存在数据盘 或 数据盘和系统盘一起直接执行转换为qcm2 \033[0m&quot;</span>    </span><br><span class="line">        virt-v2v -i libvirtxml <span class="variable">$&#123;vmware_host&#125;</span>.xml -o <span class="built_in">local</span> -os <span class="variable">$&#123;vmware_host&#125;</span>/ -of qcow2 --compressed</span><br><span class="line">        [ $? = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;vmware_host&#125;</span>vmdk导出成功 \033[0m&quot;</span></span><br><span class="line">  <span class="built_in">continue</span></span><br><span class="line">  ;;        </span><br><span class="line">3)<span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 退出格式转换 \033[0m&quot;</span> </span><br><span class="line">  <span class="built_in">break</span></span><br><span class="line">  ;;</span><br><span class="line">*)<span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;red&#125;</span> 输入错误重新输入 或 输入0获取帮助信息 \033[0m&quot;</span></span><br><span class="line">  <span class="built_in">continue</span></span><br><span class="line">  ;;   </span><br><span class="line">  <span class="keyword">esac</span> </span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">centos_could_init</span></span>() &#123;</span><br><span class="line">    <span class="comment"># centos6-7</span></span><br><span class="line">    <span class="built_in">rm</span> -rf <span class="variable">$&#123;could_init_v&#125;</span> install-cloudinit-scripts || <span class="literal">true</span></span><br><span class="line">    <span class="keyword">if</span> [ `<span class="built_in">cat</span> /etc/redhat-release |awk -F<span class="string">&#x27;[ .]+&#x27;</span> <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>` = <span class="string">&quot;CentOS&quot;</span> ];<span class="keyword">then</span></span><br><span class="line">       <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 执行卸载旧版could-init \033[0m&quot;</span> </span><br><span class="line">       yum -y remove cloud-init  ||<span class="literal">true</span></span><br><span class="line">       <span class="built_in">rm</span> -f /etc/cloud/cloud.cfg.rpmsave ||<span class="literal">true</span></span><br><span class="line">       yum install -y unzip wget</span><br><span class="line">       [ ! -f <span class="variable">$&#123;could_init_v&#125;</span> ] &amp;&amp; wget <span class="variable">$&#123;could_init&#125;</span></span><br><span class="line">       unzip <span class="variable">$&#123;could_init_v&#125;</span></span><br><span class="line">       <span class="built_in">chmod</span> a+x install-cloudinit-scripts/ -R</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="comment"># install centos could-init部分 </span></span><br><span class="line">    centos_version=`<span class="built_in">cat</span> /etc/redhat-release |awk -F<span class="string">&#x27;[ .]+&#x27;</span> <span class="string">&#x27;&#123;print $1 $4&#125;&#x27;</span>`</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$&#123;centos_version&#125;</span> = <span class="string">&quot;CentOS7&quot;</span> ];<span class="keyword">then</span> </span><br><span class="line">       <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;centos_version&#125;</span>执行安装could-init \033[0m&quot;</span> </span><br><span class="line">       <span class="built_in">cd</span> install-cloudinit-scripts &amp;&amp; bash CentOS7-install-cloudinit.sh</span><br><span class="line">       systemctl start cloud-init &amp;&amp; systemctl status cloud-init </span><br><span class="line">       [ <span class="variable">$&#123;?&#125;</span> = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;centos_version&#125;</span> could-init 安装成功！ \033[0m&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> [ <span class="variable">$&#123;centos_version&#125;</span> = <span class="string">&quot;CentOS6&quot;</span> ];</span><br><span class="line">       <span class="keyword">then</span></span><br><span class="line">       <span class="built_in">cd</span> install-cloudinit-scripts &amp;&amp; bash CentOS6-install-cloudinit.sh</span><br><span class="line">       systemctl start cloud-init &amp;&amp; systemctl status cloud-init </span><br><span class="line">       [ <span class="variable">$&#123;?&#125;</span> = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;centos_version&#125;</span> could-init 安装成功！ \033[0m&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> [ <span class="variable">$&#123;centos_version&#125;</span> = <span class="string">&quot;CentOS8&quot;</span> ];</span><br><span class="line">       <span class="keyword">then</span></span><br><span class="line">       <span class="built_in">cd</span> install-cloudinit-scripts &amp;&amp; bash CentOS8-install-cloudinit.sh</span><br><span class="line">       systemctl start cloud-init &amp;&amp; systemctl status cloud-init </span><br><span class="line">       [ <span class="variable">$&#123;?&#125;</span> = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;centos_version&#125;</span> could-init 安装成功！ \033[0m&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">ubuntu_could_init</span></span>()&#123;</span><br><span class="line">    <span class="comment"># ubuntu</span></span><br><span class="line">    <span class="built_in">rm</span> -rf <span class="variable">$&#123;could_init_v&#125;</span> install-cloudinit-scripts || <span class="literal">true</span></span><br><span class="line">    <span class="keyword">if</span> [ `<span class="built_in">cat</span> /etc/lsb-release |awk -F<span class="string">&#x27;[ =]+&#x27;</span> <span class="string">&#x27;NR==1&#123;print $2&#125;&#x27;</span>` = <span class="string">&quot;Ubuntu&quot;</span> ];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> 执行卸载旧版could-init \033[0m&quot;</span> </span><br><span class="line">        apt-get -y remove cloud-init ||<span class="literal">true</span></span><br><span class="line">        apt install -y unzip wget</span><br><span class="line">        <span class="built_in">rm</span> -rf /etc/cloud/* ||<span class="literal">true</span></span><br><span class="line">        <span class="built_in">rm</span> -rf /usr/lib/python2.7/dist-packages/cloudinit ||<span class="literal">true</span></span><br><span class="line">        [ ! -f <span class="variable">$&#123;could_init_v&#125;</span> ] &amp;&amp; wget <span class="variable">$&#123;could_init&#125;</span></span><br><span class="line">        unzip <span class="variable">$&#123;could_init_v&#125;</span></span><br><span class="line">        <span class="built_in">chmod</span> a+x install-cloudinit-scripts/ -R</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="comment"># install ubuntu could-init部分 </span></span><br><span class="line">    ubuntu_version=`<span class="built_in">cat</span> /etc/lsb-release |awk -F<span class="string">&#x27;[ =]+&#x27;</span> <span class="string">&#x27;NR==1&#123;print $2&#125;&#x27;</span>`</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$&#123;ubuntu_version&#125;</span> = <span class="string">&quot;Ubuntu&quot;</span> ];<span class="keyword">then</span> </span><br><span class="line">       <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;ubuntu_version&#125;</span>执行安装could-init \033[0m&quot;</span> </span><br><span class="line">       <span class="built_in">cd</span> install-cloudinit-scripts &amp;&amp; bash Ubuntu-install-cloudinit.sh</span><br><span class="line">       systemctl start cloud-init &amp;&amp; systemctl status cloud-init</span><br><span class="line">       [ <span class="variable">$&#123;?&#125;</span> = 0 ] &amp;&amp; <span class="built_in">echo</span> -e <span class="string">&quot;\033[<span class="variable">$&#123;green&#125;</span> <span class="variable">$&#123;ubuntu_version&#125;</span>执行安装could-init成功! \033[0m&quot;</span></span><br><span class="line">    <span class="keyword">fi</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">        <span class="comment">#//environment (不存在的模块)</span></span><br><span class="line">        export_vmware</span><br><span class="line">        change_format</span><br><span class="line">        <span class="comment">#centos_could_init  导入云平台后注释其他模块 按系统类型选择取消could-init的注释安装项目 </span></span><br><span class="line">        <span class="comment">#ubuntu_could_init  导入云平台后注释其他模块 按系统类型选择取消could-init的注释安装项目</span></span><br><span class="line">&#125;</span><br><span class="line">main</span><br></pre></td></tr></table></figure>

<h3 id="二-脚本执行方式"><a href="#二-脚本执行方式" class="headerlink" title="二. 脚本执行方式"></a>二. 脚本执行方式</h3><ol>
<li><p>脚本会先执行安装各种需要的驱动并且列出vmware虚拟机列表 选取输入</p>
</li>
<li><p>export_vmware模块会导出vmware虚拟机为raw格式</p>
</li>
<li><p>change_format模块会将raw格式转化为qcm2格式 此处可选系统盘数据盘一起转换格式 或者单独转换系统盘格式 原xml文件会默认以.bak格式备份</p>
</li>
<li><p>最后手动将系统盘qcm2格式传入云私有对象存储 并创建云主机  并挂载一块磁盘采用dd的方式或qemu的方式将raw格式数据盘进行数据同步</p>
</li>
</ol>
<p>截图：</p>
<img src="/2023/05/12/vmware-v2v%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC/image-20230516111248633.png" alt="image-20230516111248633" style="zoom:50%;">

<img src="/2023/05/12/vmware-v2v%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC/image-20230516111702414.png" alt="image-20230516111702414" style="zoom:50%;">

<img src="/2023/05/12/vmware-v2v%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC/image-20230516112119735.png" alt="image-20230516112119735" style="zoom: 50%;">

<p>祝好。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/12/vmware-v2v%E8%BF%81%E7%A7%BB%E8%84%9A%E6%9C%AC/" data-id="cli02gthk001h8cqm4fme0mv7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/change-cloub/" rel="tag">change-cloub</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-写文章默认加签" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/11/%E5%86%99%E6%96%87%E7%AB%A0%E9%BB%98%E8%AE%A4%E5%8A%A0%E7%AD%BE/" class="article-date">
  <time datetime="2023-05-11T12:02:31.000Z" itemprop="datePublished">2023-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/club/">club</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/11/%E5%86%99%E6%96%87%E7%AB%A0%E9%BB%98%E8%AE%A4%E5%8A%A0%E7%AD%BE/">写文章默认加签</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>一. 前言</p>
<p>模板与特定页面<br>项目Kratos-Rebirth-Specified-Pages已经废弃，所有功能均已内置，无需使用额外的模块。<br>此处给出我使用的scaffolds/post.md文件内容：</p>
<p>二. 写文章默认加签</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">title: 文章标题</span><br><span class="line">date: 2018-03-24 15:31:36</span><br><span class="line">categories: Demo</span><br><span class="line">tags:</span><br><span class="line">- Tag0</span><br><span class="line">- Tag1</span><br><span class="line">- Tag2</span><br><span class="line">sticky: 100</span><br><span class="line">pic:</span><br><span class="line">comments: true</span><br><span class="line">toc: true</span><br><span class="line">expire: true</span><br><span class="line">only:</span><br><span class="line">- home</span><br><span class="line">- category</span><br><span class="line">- tag</span><br></pre></td></tr></table></figure>

<p>三. 作者使用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">categories:</span><br><span class="line">tags:</span><br><span class="line">pic:</span><br><span class="line">comments: true</span><br><span class="line">toc: true</span><br><span class="line">---</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/11/%E5%86%99%E6%96%87%E7%AB%A0%E9%BB%98%E8%AE%A4%E5%8A%A0%E7%AD%BE/" data-id="cli02gthp001y8cqmh3vc8v6c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/club/" rel="tag">club</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-zabbix6-0搭建" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/" class="article-date">
  <time datetime="2023-05-11T06:55:53.000Z" itemprop="datePublished">2023-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/">云原生监控</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/">zabbix6.0搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="zabbix6-0"><a href="#zabbix6-0" class="headerlink" title="zabbix6.0"></a><code>zabbix6.0</code></h2><p>环境：<code>ubuntu18.04</code></p>
<h4 id="一-换源-安装常用软件-下载deb包"><a href="#一-换源-安装常用软件-下载deb包" class="headerlink" title="一. 换源 / 安装常用软件 / 下载deb包"></a>一. 换源 / 安装常用软件 / 下载<code>deb</code>包</h4><p>换源见链接： <a target="_blank" rel="noopener" href="https://developer.aliyun.com/mirror/ubuntu?spm=a2c6h.13651102.0.0.3e221b11daA4Kl">https://developer.aliyun.com/mirror/ubuntu?spm=a2c6h.13651102.0.0.3e221b11daA4Kl</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装常用软件</span></span><br><span class="line">apt install -y lrzsz vim wget </span><br><span class="line"><span class="comment"># 下载并安装deb包</span></span><br><span class="line">wget https://repo.zabbix.com/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.0-4+ubuntu18.04_all.deb</span><br><span class="line">dpkg -i zabbix-release_6.0-4+ubuntu18.04_all.deb</span><br><span class="line">apt update</span><br></pre></td></tr></table></figure>

<h4 id="二-安装Zabbix-server，Web前端，agent"><a href="#二-安装Zabbix-server，Web前端，agent" class="headerlink" title="二. 安装Zabbix server，Web前端，agent"></a>二. 安装<code>Zabbix server，Web</code>前端，<code>agent</code></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install zabbix-server-mysql zabbix-frontend-php zabbix-nginx-conf zabbix-sql-scripts zabbix-agent -y</span><br></pre></td></tr></table></figure>

<h4 id="三-安装mysql（mysql5-7-可选）"><a href="#三-安装mysql（mysql5-7-可选）" class="headerlink" title="三. 安装mysql（mysql5.7 可选）"></a>三. 安装<code>mysql</code>（<code>mysql5.7</code> 可选）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清华镜像源 / 阿里源 / 腾讯源</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ xenial-security main restricted universe multiverse</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装mysql5.7服务端 / 安装mysql5.7客户端</span></span><br><span class="line">sudo apt-get install mysql-server-5.7 mysql-client-5.7 -y</span><br></pre></td></tr></table></figure>

<h4 id="四-初始化数据库"><a href="#四-初始化数据库" class="headerlink" title="四. 初始化数据库"></a>四. 初始化数据库</h4><p>扩展：数据库版本若为8.0及以上数据库初始密码存放于<code> cat /var/log/mysqld.log |grep &#39;temporary password&#39; &gt; passwd.txt</code> 其他版本直接输入<code>mysql</code>即可登录。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更改初始密码</span></span><br><span class="line">ALTER USER root@localhost IDENTIFIED BY &#x27;zabbix&#x27;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">初始化zabbix mysql配置</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql -uroot -p</span></span><br><span class="line">create database zabbix character set utf8mb4 collate utf8mb4_bin;</span><br><span class="line">create user zabbix@localhost identified by &#x27;zabbix&#x27;;</span><br><span class="line">grant all privileges on zabbix.* to zabbix@localhost;</span><br><span class="line">set global log_bin_trust_function_creators = 1;</span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line">quit;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">导入初始架构和数据，系统将提示您输入新创建的密码。</span></span><br><span class="line">zcat /usr/share/zabbix-sql-scripts/mysql/server.sql.gz | mysql --default-character-set=utf8mb4 -uzabbix -p zabbix</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">导入数据库后禁用 log_bin_trust_function_creators （可选）</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql -uroot -p</span></span><br><span class="line">set global log_bin_trust_function_creators = 0;</span><br><span class="line">quit;</span><br></pre></td></tr></table></figure>

<p>导入成功截图：</p>
<img src="/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/image-20230504142549365.png" alt="image-20230504142549365" style="zoom: 67%;">

<h4 id="五-为zabbix配置数据库"><a href="#五-为zabbix配置数据库" class="headerlink" title="五. 为zabbix配置数据库"></a>五. 为<code>zabbix</code>配置数据库</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为Zabbix server配置数据库 编辑配置文件 /etc/zabbix/zabbix_server.conf</span></span><br><span class="line"><span class="comment"># 修改如下参数</span></span><br><span class="line">DBHost=localhost</span><br><span class="line">DBName=zabbix</span><br><span class="line">DBUser=zabbix</span><br><span class="line">DBPassword=zabbix</span><br><span class="line">AllowUnsupportedDBVersions=1 </span><br><span class="line">VMwareCacheSize=2G   <span class="comment"># （新增增大缓存空间）</span></span><br><span class="line">CacheSize=8G         <span class="comment"># （新增增大缓存空间）</span></span><br></pre></td></tr></table></figure>

<img src="/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/image-20230504151458211.png" alt="image-20230504151458211" style="zoom:67%;">

<h4 id="六-为Zabbix前端配置PHP-可选"><a href="#六-为Zabbix前端配置PHP-可选" class="headerlink" title="六. 为Zabbix前端配置PHP ( 可选 )"></a>六. 为<code>Zabbix</code>前端配置<code>PHP </code>( 可选 )</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编辑配置文件 /etc/zabbix/nginx.conf uncomment and <span class="built_in">set</span> <span class="string">&#x27;listen&#x27;</span> and <span class="string">&#x27;server_name&#x27;</span> directives.</span></span><br><span class="line">listen 8080;</span><br><span class="line">server_name 10.0.0.10;</span><br></pre></td></tr></table></figure>

<h4 id="七-启动Zabbix-server和agent进程-启动Zabbix-server和agent进程，并为它们设置开机自启："><a href="#七-启动Zabbix-server和agent进程-启动Zabbix-server和agent进程，并为它们设置开机自启：" class="headerlink" title="七. 启动Zabbix server和agent进程 启动Zabbix server和agent进程，并为它们设置开机自启："></a>七. 启动<code>Zabbix server</code>和<code>agent</code>进程 启动<code>Zabbix server</code>和<code>agent</code>进程，并为它们设置开机自启：</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart zabbix-server zabbix-agent nginx php7.2-fpm</span><br><span class="line">systemctl  <span class="built_in">enable</span> zabbix-server zabbix-agent nginx php7.2-fpm</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/image-20230504151013465.png" alt="image-20230504151013465"></p>
<p>八. 效果  ( 配置完成前端后 <code>Admin / zabbix </code>登录 )</p>
<p><img src="/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/image-20230504151859238.png" alt="image-20230504151859238"></p>
<p>教程结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/11/zabbix6-0%E6%90%AD%E5%BB%BA/" data-id="cli02gthk001j8cqmgozh66b3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/" rel="tag">云原生监控</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/" rel="tag">常用软件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-云" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/10/%E4%BA%91/" class="article-date">
  <time datetime="2023-05-10T15:20:43.000Z" itemprop="datePublished">2023-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/10/%E4%BA%91/">云计算学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="云计算"><a href="#云计算" class="headerlink" title="云计算"></a>云计算</h3><p>前言：</p>
<p>云计算初学比较难但只要一步一步来还是很容易的</p>
<p>云计算就是：一台物理设备虚拟为很多台设备 达到资源的最高利用率 传统一台物理服务器只能 跑一个操作系统</p>
<p>云计算则一台服务器可以跑多台设备各种操作系统 如云计算一台物理机上面可以运行 windows ubuntu macos centos等任何v系统 云计算公司如：华为云 阿里云 腾讯云等 我们常使用的百度网盘就是云计算的一种其底层是分布式存储ceph 在云计算领域百度网盘这样的 又叫对象存储</p>
<p><img src="/2023/05/10/%E4%BA%91/image-20230511211624858.png" alt="image-20230511211624858"></p>
<h2 id="一-基础部分"><a href="#一-基础部分" class="headerlink" title="一. 基础部分"></a>一. 基础部分</h2><p>电脑下载一个workstdtion workstdtion安装一个ubuntu18.04操作系统系统你先学个linux 把这些视频看完: </p>
<p>学习linux<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV14z4y1Q7Hm/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV14z4y1Q7Hm/?spm_id_from=333.999.0.0</a><br>学习shell脚本：<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1XB4y1P7Sh/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1XB4y1P7Sh/?spm_id_from=333.999.0.0</a><br>学习mysql:<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1KW411u7vy/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1KW411u7vy/?spm_id_from=333.999.0.0</a><br>学习docker:<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ls411n7mx/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1Ls411n7mx/?spm_id_from=333.999.0.0</a><br>学习常用监控软件 telegraf，prometheus，grafana , influxdb ：<br>关注微信公众号麦逗搞IT 查看prometheus  telegraf grafana学习视频 </p>
<h2 id="二-云计算部分"><a href="#二-云计算部分" class="headerlink" title="二. 云计算部分"></a>二. 云计算部分</h2><p>学习：vmware ,vcenter，exsi虚拟化<br>学习：openstack<br>学习：分布式存储 ceph</p>
<h2 id="三-监控部分概览-（-用于大致了解容器技术-）"><a href="#三-监控部分概览-（-用于大致了解容器技术-）" class="headerlink" title="三. 监控部分概览 （ 用于大致了解容器技术 ）"></a>三. 监控部分概览 （ 用于大致了解容器技术 ）</h2><p>监控linux指标 grafana出图效果：</p>
<p><img src="/2023/05/10/%E4%BA%91/image.png" alt="img"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/10/%E4%BA%91/" data-id="cli02gthm001o8cqmc5k81kce" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="tag">云计算</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/05/23/hello-world/" class="article-date">
  <time datetime="2023-05-23T09:10:04.606Z" itemprop="datePublished">2023-05-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/05/23/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://gegewu12.gitee.io/2023/05/23/hello-world/" data-id="cli02gth8000n8cqm3jlhht60" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/centos/">centos</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/club/">club</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/py/">py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ubuntu/">ubuntu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/">云原生监控</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%91%E8%AE%A1%E7%AE%97/">云计算</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/">常用软件</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/">环境部署</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%81%E4%BA%91/">迁云</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/change-cloub/" rel="tag">change-cloub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/club/" rel="tag">club</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/" rel="tag">云原生监控</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="tag">云计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/" rel="tag">常用软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" rel="tag">环境部署</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/centos/" style="font-size: 15px;">centos</a> <a href="/tags/change-cloub/" style="font-size: 10px;">change-cloub</a> <a href="/tags/club/" style="font-size: 16.67px;">club</a> <a href="/tags/docker/" style="font-size: 13.33px;">docker</a> <a href="/tags/mysql/" style="font-size: 13.33px;">mysql</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/shell/" style="font-size: 11.67px;">shell</a> <a href="/tags/ubuntu/" style="font-size: 15px;">ubuntu</a> <a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F%E7%9B%91%E6%8E%A7/" style="font-size: 11.67px;">云原生监控</a> <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 13.33px;">云计算</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6/" style="font-size: 20px;">常用软件</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/" style="font-size: 18.33px;">环境部署</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/23/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2023/05/23/butterfly%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE/">butterfly主题设置</a>
          </li>
        
          <li>
            <a href="/2023/05/23/%E7%95%99%E8%A8%80%E6%9D%BF/">留言板</a>
          </li>
        
          <li>
            <a href="/2023/05/23/growpart%E7%A3%81%E7%9B%98%E7%83%AD%E6%89%A9%E5%AE%B9/">growpart磁盘热扩容</a>
          </li>
        
          <li>
            <a href="/2023/05/23/smtplib%E5%8F%91%E9%80%81%E6%AD%A3%E6%96%87%E5%B8%A6%E5%9B%BE%E7%89%87%E9%99%84%E5%8A%A0%E6%A0%BC%E5%BC%8F%E7%9A%84%E9%82%AE%E4%BB%B6%E5%88%B0QQ%E9%82%AE%E7%AE%B1/">smtplib发送正文带图片附加格式的邮件到QQ邮箱</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 zznn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>